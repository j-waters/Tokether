(function(e){function t(t){for(var o,i,a=t[0],s=t[1],u=t[2],d=0,f=[];d<a.length;d++)i=a[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);l&&l(t);while(f.length)f.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],o=!0,a=1;a<n.length;a++){var s=n[a];0!==r[s]&&(o=!1)}o&&(c.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={app:0},c=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=s;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"045b":function(e,t,n){"use strict";n("decc")},"14cd":function(e,t,n){"use strict";n("2019")},1562:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="1562"},1911:function(e,t,n){},"1e96":function(e,t,n){},2019:function(e,t,n){},"2e10":function(e,t,n){},"380c":function(e,t,n){"use strict";n("2e10")},"92e6":function(e,t,n){"use strict";n("1911")},"944d":function(e,t,n){},b21e:function(e,t,n){},c6bf:function(e,t,n){"use strict";n("b21e")},cd49:function(e,t,n){"use strict";n.r(t);n("fd85"),n("15db"),n("c026"),n("4031");var o=n("79c4");function r(e,t){var n=Object(o["resolveComponent"])("router-view");return Object(o["openBlock"])(),Object(o["createBlock"])(n)}n("045b");var c=n("41ec"),i=n.n(c);const a={},s=i()(a,[["render",r]]);var u=s,l=n("1740");Object(l["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var d=n("3608"),f=n("2e1a"),p=n("57d2"),v=n("7a28"),b=(n("c1c3"),n("494a"),n("2631"),n("966c"),n("9588"),n("241c"),n("862d"),n("bc0d"));n("32ec"),n("c35d"),n("09f6"),n("da30"),n("f950"),n("f542");function m(e){return h.apply(this,arguments)}function h(){return h=Object(v["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.clone().json().catch((function(){return console.log("err")}));case 5:return n.parsedBody=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function w(e){return g.apply(this,arguments)}function g(){return g=Object(v["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m("https://www.tiktok.com/oembed?url=".concat(t));case 2:return n=e.sent,e.abrupt("return",Object(f["a"])(Object(f["a"])({},n.parsedBody),{},{videoId:j(t)}));case 4:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function j(e){return e.match(/(?:video|embed)\/(\d*)/)[1]}function O(e){return"https://www.tiktok.com/embed/".concat(e)}var k=n("18b4"),y=n.n(k),x=(n("103d"),n("966e"),n("3b31"),y()(["https://tokether-relay.herokuapp.com/gun"]));n("dddc"),n("22f4"),n("e0d3"),n("90fa"),n("234e"),n("feeb"),n("1c98"),n("06a3"),n("1ca0"),n("3a0c"),n("9426"),n("100a"),n("3051"),n("9598"),n("2731"),n("587f"),n("c60d"),n("b285"),n("6a35"),n("b391"),n("1234"),n("dfa9"),n("7c3f"),n("2d6b"),n("0312"),n("1f3b"),n("c666"),n("705d"),n("f1c6"),n("e28c"),n("5a85"),n("7bea");function I(e){var t=new Uint8Array(e/2);return window.crypto.getRandomValues(t),Array.from(t,(function(e){return e.toString(16).padStart(2,"0")})).join("")}var V=n("5b98"),E=Object(b["b"])("users",{state:function(){return{userId:I(32),users:[]}},actions:{init:function(){var e=this;this.intervalId=setInterval((function(){return e.heartbeat()}),5e3),this.gunUsers.open((function(t){e.users=Object.values(t),console.log("USERSSS",e.activeUsers)}))},heartbeat:function(){this.gunUser.put({lastUpdate:(new Date).toString()})},setLoaded:function(e){this.gunUser.put({loaded:e})},leave:function(){clearInterval(this.intervalId),this.gunUsers.off()}},getters:{gunUsers:function(){var e=S();return e.gunRoom.get("users")},gunUser:function(){return this.gunUsers.get(this.userId)},activeUsers:function(){return this.users.filter((function(e){return Object(V["a"])(new Date,new Date(e.lastUpdate))<10}))},allLoaded:function(){var e=S();return this.activeUsers.every((function(t){return t.loaded==e.currentVideoId}))}}}),N=Object(b["b"])("player",{state:function(){return{playing:!1,loaded:[]}},actions:{init:function(){var e=this;window.addEventListener("message",this.onMessage,!1),this.gunPlayer.open((function(t){e.playing=t.playing,e.setIframePlaying(e.playing)}))},onMessage:function(e){if(null!=e.source&&"parent"in e.source&&e.source.parent==window&&"https://www.tiktok.com"==e.origin)switch(e.data.type){case"loaded":console.log("recv loaded",e.data.videoId),this.loaded.push(e.data.videoId);break;case"embedSetPlaying":this.setPlaying(e.data.playing);break}},leave:function(){window.removeEventListener("message",this.onMessage),this.gunPlayer.off(),this.$reset()},setIframePlaying:function(e){var t=document.querySelector(".current-iframe iframe"),n=null===t||void 0===t?void 0:t.contentWindow;null===n||void 0===n||n.postMessage({type:"parentSetPlaying",playing:e},"*")},setAllIframesPlaying:function(e){document.querySelectorAll("iframe").forEach((function(t){var n;return null===(n=t.contentWindow)||void 0===n?void 0:n.postMessage({type:"parentSetPlaying",playing:e},"*")}))},setPlaying:function(e){this.gunPlayer.put({playing:e})},unloadVideoId:function(e){this.loaded=this.loaded.filter((function(t){return t!=e}))},changedVideo:function(e){var t=this;console.log("changed video"),this.setAllIframesPlaying(!1);var n=function(){console.log("video is loaded");var n=E();if(n.setLoaded(e),n.allLoaded)t.setPlaying(!0);else var r=Object(o["watch"])((function(){return n.allLoaded}),(function(e){e&&(t.setPlaying(!0),r())}))};if(this.loaded.includes(e))console.log("already loaded"),n();else{console.log("not loaded");var r=Object(o["watch"])((function(){return t.loaded.includes(e)}),(function(e){e&&n(),r()}))}}},getters:{gunPlayer:function(){var e=S();return e.gunRoom.get("player")}}});function R(e){return 0===Object.keys(e).length}var S=Object(b["b"])("room",{state:function(){return{playlist:[],roomId:null,playlistIndex:0,userId:I(32)}},actions:{leave:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.gunRoom.off(),e.$reset(),N().leave(),E().leave();case 4:case"end":return t.stop()}}),t)})))()},addVideos:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var o,r,c,i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:o=t.gunRoomState.get("playlist"),r=Object(p["a"])(e),n.prev=2,r.s();case 4:if((c=r.n()).done){n.next=15;break}if(i=c.value,""!=i){n.next=8;break}return n.abrupt("continue",13);case 8:return n.next=10,w(i);case 10:a=n.sent,console.log("add video",i),o.set({video:a});case 13:n.next=4;break;case 15:n.next=20;break;case 17:n.prev=17,n.t0=n["catch"](2),r.e(n.t0);case 20:return n.prev=20,r.f(),n.finish(20);case 23:case"end":return n.stop()}}),n,null,[[2,17,20,23]])})))()},addVideo:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.addVideos([e]);case 1:case"end":return n.stop()}}),n)})))()},createRoom:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.roomId=I(8),e.addVideos(["https://www.tiktok.com/@hardlyhardin/video/7051714436142255366","https://www.tiktok.com/@aketton/video/7053481619449040134","https://www.tiktok.com/@asimpforspidey/video/7050803584744688902","https://www.tiktok.com/@obabydriver/video/7052865133931990319","https://www.tiktok.com/@nityasweater/video/7052792237683510533","https://www.tiktok.com/@swamp_ghoul/video/7053087726479953158","https://www.tiktok.com/@mhall.22/video/7052738837570751791","https://www.tiktok.com/@rileslovesyall/video/7052447375910079790","https://www.tiktok.com/@jack.lawro/video/7052784473284300037","https://www.tiktok.com/@becauseimmissy_/video/7052747526042111238","https://www.tiktok.com/@deathpr0cess/video/7052745014476311855","https://www.tiktok.com/@jamezlaskey/video/7051587577136172293","https://www.tiktok.com/@hardlyhardin/video/7051713121609649413","https://www.tiktok.com/@benlapidus/video/7051764182508916014","https://www.tiktok.com/@futuremilfclub/video/7047313072721022254","https://www.tiktok.com/@ctrl.alt.mdlt/video/7051785107224694063","https://www.tiktok.com/@carlygarberlolk/video/7045780237828967727","https://www.tiktok.com/@mrelectricnick/video/7025423947894148353","https://www.tiktok.com/@kkirstylouise/video/7050943365084499205","https://www.tiktok.com/@lenslibrary/video/7043031245722275119","https://www.tiktok.com/@sadiewooster/video/7050447220239387910"]),e.setPlaylistIndex(0),t.next=5,Ue.push({name:"Room",params:{id:e.roomId}});case 5:case"end":return t.stop()}}),t)})))()},setPlaylistIndex:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e>=t.playlist.length&&(e=t.playlist.length-1),e<0&&(e=0),t.gunRoomState.put({playlistIndex:e});case 3:case"end":return n.stop()}}),n)})))()},nextVideo:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.setPlaylistIndex(e.playlistIndex+1);case 1:case"end":return t.stop()}}),t)})))()},prevVideo:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.setPlaylistIndex(e.playlistIndex-1);case 1:case"end":return t.stop()}}),t)})))()},ingestState:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var o,r,c,i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:c=null===(o=t.currentVideo)||void 0===o?void 0:o.videoId,i=t.playlistIndex,t.playlist=Object.values(null!==(r=e.playlist)&&void 0!==r?r:{}),t.playlistIndex=e.playlistIndex,!t.currentVideo||t.currentVideo.videoId==c&&t.playlistIndex==i||(a=N(),a.changedVideo(t.currentVideo.videoId));case 5:case"end":return n.stop()}}),n)})))()},loadRoom:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.roomId=e,o=E(),o.init(),t.gunRoomState.load((function(e){return t.ingestState(e)})),t.gunRoomState.open((function(e){t.ingestState(e)}));case 5:case"end":return n.stop()}}),n)})))()}},getters:{currentVideo:function(){var e;return null===(e=this.playlist[this.playlistIndex])||void 0===e?void 0:e.video},currentVideoId:function(){var e,t;return null!==(e=null===(t=this.currentVideo)||void 0===t?void 0:t.videoId)&&void 0!==e?e:null},enhancedPlaylist:function(){var e=this;return this.playlist.filter((function(e){return!R(e)})).map((function(t,n){return Object(f["a"])(Object(f["a"])({},t),{},{index:n,isCurrent:n==e.playlistIndex,videoId:t.video.videoId,itemId:"".concat(n,"|").concat(t.video.videoId)})}))},loadedVideos:function(){var e=this;return[this.playlistIndex-1,this.playlistIndex,this.playlistIndex+1,this.playlistIndex+2].map((function(t){return e.enhancedPlaylist[t]})).filter((function(e){return e&&e.videoId}))},gunRoom:function(){return x.get("rooms/".concat(this.roomId))},gunRoomState:function(){return this.gunRoom.get("state")}}}),P=function(e){return Object(o["pushScopeId"])("data-v-0c3de73e"),e=e(),Object(o["popScopeId"])(),e},B={class:"container"},C={class:"section has-text-centered"},_=P((function(){return Object(o["createElementVNode"])("h1",{class:"title"},[Object(o["createTextVNode"])(" Watch TikToks "),Object(o["createElementVNode"])("span",{class:"glitch-text","data-text":"Tokether"},"Tokether")],-1)})),U=P((function(){return Object(o["createElementVNode"])("p",{class:"subtitle is-3"},"Create a room and share it with your friends",-1)})),T=Object(o["defineComponent"])({setup:function(e){var t=S();return function(e,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",B,[Object(o["createElementVNode"])("section",C,[_,U,Object(o["createElementVNode"])("button",{class:"button is-primary is-large is-outlined",onClick:n[0]||(n[0]=function(e){return Object(o["unref"])(t).createRoom()})}," New room ")])])}}});n("c6bf");const L=i()(T,[["__scopeId","data-v-0c3de73e"]]);var M=L,A={class:"is-flex-grow-1"},D={class:"tiktok-wrapper"},F=["src"],q=Object(o["defineComponent"])({props:{videoId:null},setup:function(e){var t=e,n=Object(o["computed"])((function(){return O(t.videoId)}));return Object(o["onUnmounted"])((function(){var e=N();e.unloadVideoId(t.videoId)})),function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",A,[Object(o["createElementVNode"])("div",D,[Object(o["createElementVNode"])("iframe",{src:Object(o["unref"])(n),allowfullscreen:"",scrolling:"no",allow:"autoplay; encrypted-media;"},null,8,F)])])}}});n("14cd");const z=i()(q,[["__scopeId","data-v-6633e196"]]);var W=z,J={class:"box is-fh"},K={class:"is-flex is-flex-direction-column is-align-items-center is-fh"},$={class:"buttons",style:{width:"100%"}},H=Object(o["defineComponent"])({setup:function(e){var t=S(),n=N();return n.init(),function(e,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",J,[Object(o["createElementVNode"])("div",K,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(Object(o["unref"])(t).loadedVideos,(function(e){return Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createBlock"])(W,{"video-id":e.videoId,key:e.itemId,class:Object(o["normalizeClass"])({"current-iframe":e.isCurrent})},null,8,["video-id","class"])),[[o["vShow"],e.isCurrent]])})),128)),Object(o["createElementVNode"])("div",$,[Object(o["createElementVNode"])("button",{class:"button is-primary is-flex-grow-1",onClick:n[0]||(n[0]=function(e){return Object(o["unref"])(t).prevVideo()})}," Prev "),Object(o["createElementVNode"])("button",{class:"button is-primary is-flex-grow-1",onClick:n[1]||(n[1]=function(e){return Object(o["unref"])(t).nextVideo()}),onKeyup:n[2]||(n[2]=Object(o["withKeys"])((function(e){return Object(o["unref"])(t).nextVideo()}),["right"]))}," Next ",32)])])])}}});const Q=H;var Y=Q,G=(n("6991"),function(e){return Object(o["pushScopeId"])("data-v-f6d51826"),e=e(),Object(o["popScopeId"])(),e}),X={class:"is-flex is-gap-1 is-align-items-center is-justify-content-space-between"},Z={class:"has-text-grey"},ee=G((function(){return Object(o["createElementVNode"])("button",{class:"button"},"Cancel",-1)})),te=Object(o["defineComponent"])({props:{item:null},setup:function(e){var t=S();return function(n,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",X,[Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(["video-title is-clickable",{"has-text-weight-bold":e.item.isCurrent}]),onClick:r[0]||(r[0]=function(n){return Object(o["unref"])(t).setPlaylistIndex(e.item.index)})},[Object(o["createElementVNode"])("span",Z,"@"+Object(o["toDisplayString"])(e.item.video.author_name),1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.item.video.title),1)],2),ee])}}});n("92e6");const ne=i()(te,[["__scopeId","data-v-f6d51826"]]);var oe=ne,re=function(e){return Object(o["pushScopeId"])("data-v-40a1cd8c"),e=e(),Object(o["popScopeId"])(),e},ce={class:"box is-fh is-flex is-flex-direction-column"},ie={class:"is-flex-grow-1",style:{overflow:"auto"}},ae=re((function(){return Object(o["createElementVNode"])("p",{class:"help has-text-left mt-5 mb-1"}," You can also paste in a list of videos, where each one is on a new line ",-1)})),se={class:"field has-addons"},ue={class:"control",style:{width:"100%"}},le={class:"control"},de=Object(o["defineComponent"])({setup:function(e){var t=S(),n=Object(o["ref"])("");function r(){t.addVideo(n.value),n.value=""}return Object(o["watch"])(n,(function(e){e.includes("\n")&&(t.addVideos(e.split("\n")),n.value="")})),function(e,c){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",ce,[Object(o["createElementVNode"])("div",ie,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(Object(o["unref"])(t).enhancedPlaylist,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(oe,{key:e.itemId,item:e},null,8,["item"])})),128))]),ae,Object(o["createElementVNode"])("div",se,[Object(o["createElementVNode"])("p",ue,[Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{class:"input",placeholder:"Video URL","onUpdate:modelValue":c[0]||(c[0]=function(e){return n.value=e})},null,512),[[o["vModelText"],n.value]])]),Object(o["createElementVNode"])("div",le,[Object(o["createElementVNode"])("button",{class:"button is-primary",onClick:c[1]||(c[1]=function(e){return r()})},"Queue")])])])}}});n("380c");const fe=i()(de,[["__scopeId","data-v-40a1cd8c"]]);var pe=fe,ve={class:"navbar"},be={class:"container"},me={class:"navbar-brand"},he={class:"navbar-item"},we=Object(o["createTextVNode"])(" Tokether ");function ge(e,t){var n=Object(o["resolveComponent"])("router-link");return Object(o["openBlock"])(),Object(o["createElementBlock"])("nav",ve,[Object(o["createElementVNode"])("div",be,[Object(o["createElementVNode"])("div",me,[Object(o["createElementVNode"])("a",he,[Object(o["createVNode"])(n,{to:"/",class:"title is-1 glitch-text is-slow","data-text":"Tokether"},{default:Object(o["withCtx"])((function(){return[we]})),_:1})])])])])}const je={},Oe=i()(je,[["render",ge]]);var ke=Oe,ye={class:"hero"},xe={class:"hero-head"},Ie={class:"hero-body is-align-items-stretch",style:{overflow:"hidden"}},Ve={class:"container is-fh"},Ee={class:"columns is-multiline is-fh"},Ne={class:"column is-8"},Re={class:"column is-4"},Se=Object(o["defineComponent"])({props:{id:null},setup:function(e){var t=e,n=S();return n.loadRoom(t.id),Object(o["onUnmounted"])((function(){return n.leave()})),function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("section",ye,[Object(o["createElementVNode"])("div",xe,[Object(o["createVNode"])(ke)]),Object(o["createElementVNode"])("div",Ie,[Object(o["createElementVNode"])("div",Ve,[Object(o["createElementVNode"])("div",Ee,[Object(o["createElementVNode"])("div",Ne,[Object(o["createVNode"])(Y)]),Object(o["createElementVNode"])("div",Re,[Object(o["createVNode"])(pe)])])])])])}}});n("eb03");const Pe=i()(Se,[["__scopeId","data-v-704cf42f"]]);var Be=Pe,Ce=[{path:"/",name:"Home",component:M},{path:"/room/:id",name:"Room",component:Be,props:!0}],_e=Object(d["a"])({history:Object(d["b"])("/"),routes:Ce}),Ue=_e;n("944d");Object(o["createApp"])(u).use(Object(b["a"])()).use(Ue).mount("#app")},decc:function(e,t,n){},eb03:function(e,t,n){"use strict";n("1e96")}});
//# sourceMappingURL=app.cb537b7c.js.map